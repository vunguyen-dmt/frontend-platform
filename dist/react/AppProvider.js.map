{"version":3,"file":"AppProvider.js","names":["React","useState","useMemo","PropTypes","Router","OptionalReduxProvider","ErrorBoundary","AppContext","useAppEvent","getAuthenticatedUser","AUTHENTICATED_USER_CHANGED","getConfig","CONFIG_CHANGED","history","getLocale","getMessages","IntlProvider","LOCALE_CHANGED","AppProvider","store","children","config","setConfig","authenticatedUser","setAuthenticatedUser","locale","setLocale","appContextValue","propTypes","object","node","isRequired","defaultProps"],"sources":["../../src/react/AppProvider.jsx"],"sourcesContent":["import React, { useState, useMemo } from 'react';\nimport PropTypes from 'prop-types';\nimport { Router } from 'react-router-dom';\n\nimport OptionalReduxProvider from './OptionalReduxProvider';\n\nimport ErrorBoundary from './ErrorBoundary';\nimport AppContext from './AppContext';\nimport { useAppEvent } from './hooks';\nimport { getAuthenticatedUser, AUTHENTICATED_USER_CHANGED } from '../auth';\nimport { getConfig } from '../config';\nimport { CONFIG_CHANGED } from '../constants';\nimport { history } from '../initialize';\nimport {\n  getLocale,\n  getMessages,\n  IntlProvider,\n  LOCALE_CHANGED,\n} from '../i18n';\n\n/**\n * A wrapper component for React-based micro-frontends to initialize a number of common data/\n * context providers.\n *\n * ```\n * subscribe(APP_READY, () => {\n *   ReactDOM.render(\n *     <AppProvider>\n *       <HelloWorld />\n *     </AppProvider>\n *   )\n * });\n * ```\n *\n * This will provide the following to HelloWorld:\n * - An error boundary as described above.\n * - An `AppContext` provider for React context data.\n * - IntlProvider for @edx/frontend-i18n internationalization\n * - Optionally a redux `Provider`. Will only be included if a `store` property is passed to\n * `AppProvider`.\n * - A `Router` for react-router.\n *\n * @param {Object} props\n * @param {Object} [props.store] A redux store.\n * @memberof module:React\n */\nexport default function AppProvider({ store, children }) {\n  const [config, setConfig] = useState(getConfig());\n  const [authenticatedUser, setAuthenticatedUser] = useState(getAuthenticatedUser());\n  const [locale, setLocale] = useState(getLocale());\n\n  useAppEvent(AUTHENTICATED_USER_CHANGED, () => {\n    setAuthenticatedUser(getAuthenticatedUser());\n  });\n\n  useAppEvent(CONFIG_CHANGED, () => {\n    setConfig(getConfig());\n  });\n\n  useAppEvent(LOCALE_CHANGED, () => {\n    setLocale(getLocale());\n  });\n\n  const appContextValue = useMemo(() => ({ authenticatedUser, config, locale }), [authenticatedUser, config, locale]);\n\n  return (\n    <IntlProvider locale={locale} messages={getMessages()}>\n      <ErrorBoundary>\n        <AppContext.Provider\n          value={appContextValue}\n        >\n          <OptionalReduxProvider store={store}>\n            <Router history={history}>\n              {children}\n            </Router>\n          </OptionalReduxProvider>\n        </AppContext.Provider>\n      </ErrorBoundary>\n    </IntlProvider>\n  );\n}\n\nAppProvider.propTypes = {\n  // eslint-disable-next-line react/forbid-prop-types\n  store: PropTypes.object,\n  children: PropTypes.node.isRequired,\n};\n\nAppProvider.defaultProps = {\n  store: null,\n};\n"],"mappings":";;;;;;;;;;;;AAAA,OAAOA,KAAP,IAAgBC,QAAhB,EAA0BC,OAA1B,QAAyC,OAAzC;AACA,OAAOC,SAAP,MAAsB,YAAtB;AACA,SAASC,MAAT,QAAuB,kBAAvB;AAEA,OAAOC,qBAAP,MAAkC,yBAAlC;AAEA,OAAOC,aAAP,MAA0B,iBAA1B;AACA,OAAOC,UAAP,MAAuB,cAAvB;AACA,SAASC,WAAT,QAA4B,SAA5B;AACA,SAASC,oBAAT,EAA+BC,0BAA/B,QAAiE,SAAjE;AACA,SAASC,SAAT,QAA0B,WAA1B;AACA,SAASC,cAAT,QAA+B,cAA/B;AACA,SAASC,OAAT,QAAwB,eAAxB;AACA,SACEC,SADF,EAEEC,WAFF,EAGEC,YAHF,EAIEC,cAJF,QAKO,SALP;AAOA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AACA,eAAe,SAASC,WAAT,OAA0C;EAAA,IAAnBC,KAAmB,QAAnBA,KAAmB;EAAA,IAAZC,QAAY,QAAZA,QAAY;;EACvD,gBAA4BnB,QAAQ,CAACU,SAAS,EAAV,CAApC;EAAA;EAAA,IAAOU,MAAP;EAAA,IAAeC,SAAf;;EACA,iBAAkDrB,QAAQ,CAACQ,oBAAoB,EAArB,CAA1D;EAAA;EAAA,IAAOc,iBAAP;EAAA,IAA0BC,oBAA1B;;EACA,iBAA4BvB,QAAQ,CAACa,SAAS,EAAV,CAApC;EAAA;EAAA,IAAOW,MAAP;EAAA,IAAeC,SAAf;;EAEAlB,WAAW,CAACE,0BAAD,EAA6B,YAAM;IAC5Cc,oBAAoB,CAACf,oBAAoB,EAArB,CAApB;EACD,CAFU,CAAX;EAIAD,WAAW,CAACI,cAAD,EAAiB,YAAM;IAChCU,SAAS,CAACX,SAAS,EAAV,CAAT;EACD,CAFU,CAAX;EAIAH,WAAW,CAACS,cAAD,EAAiB,YAAM;IAChCS,SAAS,CAACZ,SAAS,EAAV,CAAT;EACD,CAFU,CAAX;EAIA,IAAMa,eAAe,GAAGzB,OAAO,CAAC;IAAA,OAAO;MAAEqB,iBAAiB,EAAjBA,iBAAF;MAAqBF,MAAM,EAANA,MAArB;MAA6BI,MAAM,EAANA;IAA7B,CAAP;EAAA,CAAD,EAAgD,CAACF,iBAAD,EAAoBF,MAApB,EAA4BI,MAA5B,CAAhD,CAA/B;EAEA,oBACE,oBAAC,YAAD;IAAc,MAAM,EAAEA,MAAtB;IAA8B,QAAQ,EAAEV,WAAW;EAAnD,gBACE,oBAAC,aAAD,qBACE,oBAAC,UAAD,CAAY,QAAZ;IACE,KAAK,EAAEY;EADT,gBAGE,oBAAC,qBAAD;IAAuB,KAAK,EAAER;EAA9B,gBACE,oBAAC,MAAD;IAAQ,OAAO,EAAEN;EAAjB,GACGO,QADH,CADF,CAHF,CADF,CADF,CADF;AAeD;AAEDF,WAAW,CAACU,SAAZ,GAAwB;EACtB;EACAT,KAAK,EAAEhB,SAAS,CAAC0B,MAFK;EAGtBT,QAAQ,EAAEjB,SAAS,CAAC2B,IAAV,CAAeC;AAHH,CAAxB;AAMAb,WAAW,CAACc,YAAZ,GAA2B;EACzBb,KAAK,EAAE;AADkB,CAA3B"}