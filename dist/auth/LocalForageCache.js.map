{"version":3,"file":"LocalForageCache.js","names":["localforage","memoryDriver","setupCache","defaultKeyGenerator","defaultHeaderInterpreter","buildStorage","axios","configureCache","defineDriver","forageStore","createInstance","driver","INDEXEDDB","LOCALSTORAGE","_driver","name","forageStoreAdapter","find","key","getItem","result","JSON","parse","set","value","setItem","stringify","remove","removeItem","create","ttl","storage","generateKey","headerInterpreter","debug","console","log"],"sources":["../../src/auth/LocalForageCache.js"],"sourcesContent":["/* eslint-disable no-underscore-dangle */\nimport localforage from 'localforage';\nimport memoryDriver from 'localforage-memoryStorageDriver';\nimport {\n  setupCache,\n  defaultKeyGenerator,\n  defaultHeaderInterpreter,\n  buildStorage,\n} from 'axios-cache-interceptor';\nimport axios from 'axios';\n\n/**\n * Async function to configure localforage and setup the cache\n *\n * @returns {Promise} A promise that, when resolved, returns an axios instance configured to\n * use localforage as a cache.\n */\nexport default async function configureCache() {\n  // Register the imported `memoryDriver` to `localforage`\n  await localforage.defineDriver(memoryDriver);\n\n  // Create `localforage` instance\n  const forageStore = localforage.createInstance({\n    // List of drivers used\n    driver: [\n      localforage.INDEXEDDB,\n      localforage.LOCALSTORAGE,\n      memoryDriver._driver,\n    ],\n    name: 'edx-cache',\n  });\n\n  const forageStoreAdapter = buildStorage({\n    async find(key) {\n      const result = await forageStore.getItem(`axios-cache:${key}`);\n      return JSON.parse(result);\n    },\n\n    async set(key, value) {\n      await forageStore.setItem(`axios-cache:${key}`, JSON.stringify(value));\n    },\n\n    async remove(key) {\n      await forageStore.removeItem(`axios-cache:${key}`);\n    },\n  });\n\n  // only GET methods are cached by default\n  return setupCache(\n    // axios instance\n    axios.create(),\n    {\n      ttl: 5 * 60 * 1000, // default maxAge of 5 minutes\n      // The storage to save the cache data. There are more available by default.\n      //\n      // https://axios-cache-interceptor.js.org/#/pages/storages\n      storage: forageStoreAdapter,\n\n      // The mechanism to generate a unique key for each request.\n      //\n      // https://axios-cache-interceptor.js.org/#/pages/request-id\n      generateKey: defaultKeyGenerator,\n\n      // The mechanism to interpret headers (when cache.interpretHeader is true).\n      //\n      // https://axios-cache-interceptor.js.org/#/pages/global-configuration?id=headerinterpreter\n      headerInterpreter: defaultHeaderInterpreter,\n\n      // The function that will receive debug information.\n      // NOTE: For this to work, you need to enable development mode.\n      //\n      // https://axios-cache-interceptor.js.org/#/pages/development-mode\n      // https://axios-cache-interceptor.js.org/#/pages/global-configuration?id=debug\n      // eslint-disable-next-line no-console\n      debug: console.log,\n    },\n  );\n}\n"],"mappings":";;+CACA,oJ;;;;;;AADA;AACA,OAAOA,WAAP,MAAwB,aAAxB;AACA,OAAOC,YAAP,MAAyB,iCAAzB;AACA,SACEC,UADF,EAEEC,mBAFF,EAGEC,wBAHF,EAIEC,YAJF,QAKO,yBALP;AAMA,OAAOC,KAAP,MAAkB,OAAlB;AAEA;AACA;AACA;AACA;AACA;AACA;;AACA,wBAA8BC,cAA9B;EAAA;AAAA;;;+EAAe;IAAA;IAAA;MAAA;QAAA;UAAA;YAAA;YAAA,OAEPP,WAAW,CAACQ,YAAZ,CAAyBP,YAAzB,CAFO;;UAAA;YAIb;YACMQ,WALO,GAKOT,WAAW,CAACU,cAAZ,CAA2B;cAC7C;cACAC,MAAM,EAAE,CACNX,WAAW,CAACY,SADN,EAENZ,WAAW,CAACa,YAFN,EAGNZ,YAAY,CAACa,OAHP,CAFqC;cAO7CC,IAAI,EAAE;YAPuC,CAA3B,CALP;YAePC,kBAfO,GAecX,YAAY,CAAC;cAChCY,IADgC,gBAC3BC,GAD2B,EACtB;gBAAA;kBAAA;kBAAA;oBAAA;sBAAA;wBAAA;0BAAA;0BAAA,OACOT,WAAW,CAACU,OAAZ,uBAAmCD,GAAnC,EADP;;wBAAA;0BACRE,MADQ;0BAAA,iCAEPC,IAAI,CAACC,KAAL,CAAWF,MAAX,CAFO;;wBAAA;wBAAA;0BAAA;sBAAA;oBAAA;kBAAA;gBAAA;cAGf,CAJqC;cAMhCG,GANgC,eAM5BL,GAN4B,EAMvBM,KANuB,EAMhB;gBAAA;kBAAA;oBAAA;sBAAA;wBAAA;0BAAA;0BAAA,OACdf,WAAW,CAACgB,OAAZ,uBAAmCP,GAAnC,GAA0CG,IAAI,CAACK,SAAL,CAAeF,KAAf,CAA1C,CADc;;wBAAA;wBAAA;0BAAA;sBAAA;oBAAA;kBAAA;gBAAA;cAErB,CARqC;cAUhCG,MAVgC,kBAUzBT,GAVyB,EAUpB;gBAAA;kBAAA;oBAAA;sBAAA;wBAAA;0BAAA;0BAAA,OACVT,WAAW,CAACmB,UAAZ,uBAAsCV,GAAtC,EADU;;wBAAA;wBAAA;0BAAA;sBAAA;oBAAA;kBAAA;gBAAA;cAEjB;YAZqC,CAAD,CAf1B,EA8Bb;;YA9Ba,kCA+BNhB,UAAU,EACf;YACAI,KAAK,CAACuB,MAAN,EAFe,EAGf;cACEC,GAAG,EAAE,IAAI,EAAJ,GAAS,IADhB;cACsB;cACpB;cACA;cACA;cACAC,OAAO,EAAEf,kBALX;cAOE;cACA;cACA;cACAgB,WAAW,EAAE7B,mBAVf;cAYE;cACA;cACA;cACA8B,iBAAiB,EAAE7B,wBAfrB;cAiBE;cACA;cACA;cACA;cACA;cACA;cACA8B,KAAK,EAAEC,OAAO,CAACC;YAvBjB,CAHe,CA/BJ;;UAAA;UAAA;YAAA;QAAA;MAAA;IAAA;EAAA,C"}